<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إعادة تعيين كلمة المرور</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        input, button { padding: 10px; margin: 10px 0; width: 100%; }
        button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <h2>إعادة تعيين كلمة المرور</h2>
    <input type="password" id="new-password" placeholder="أدخل كلمة المرور الجديدة" />
    <button id="update-button">تحديث كلمة المرور</button>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
        // ✅ إصلاح المتغيرات
        const supabaseUrl = "https://kirhitjejcjimdfzotse.supabase.co";
        const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtpcmhpdGplamNqaW1kZnpvdHNlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1NjUxNDQsImV4cCI6MjA3MTE0MTE0NH0.Xfk9wFjIjbav-ZYN58yH05Aelxk9yHTuEICMBUOtD3E";
        
        // ✅ إصلاح إنشاء العميل
        const { createClient } = supabase;
        const supabaseClient = createClient(supabaseUrl, supabaseKey);

        // ✅ إصلاح منطق التحديث
        document.getElementById("update-button").onclick = async function() {
            const newPassword = document.getElementById("new-password").value;
            
            if (!newPassword) {
                alert("من فضلك أدخل كلمة مرور جديدة.");
                return;
            }

            try {
                const { data, error } = await supabaseClient.auth.updateUser({
                    password: newPassword
                });

                if (error) {
                    alert("حدث خطأ: " + error.message);
                } else {
                    alert("تم تحديث كلمة المرور بنجاح!");
                }
            } catch (err) {
                alert("خطأ: " + err.message);
            }
        };
    </script>
</body>
</html>
